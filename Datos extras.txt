Hablemos sobre Est치ndares de Seguridad y OAuth 2.0



Share
Gracias a los est치ndares de seguridad podemos compartir flujos de autorizaci칩n y autenticaci칩n entre diferentes aplicaciones, es decir, podemos aprender el paso a paso de c칩mo funcionan estos servicios y aplicarlos para proteger nuestras aplicaciones.

Vamos a analizar el stack de seguridad m치s utilizado en el mercado por aplicaciones modernas. Si quieres aprender a utilizarlos en proyectos 100% reales puedes tomar el Curso de Autenticaci칩n con OAuth de Platzi.

Autenticaci칩n vs. Autorizaci칩n
Antes de analizar nuestras tecnolog칤as debemos entender las diferencias entre Autenticaci칩n y Autorizaci칩n. As칤, podemos entender mucho mejor los objetivos de las tecnolog칤as que vamos a implementar en nuestros proyectos.

Autenticaci칩n: Consiste en verificar la identidad de nuestros usuarios, debemos asegurarnos de que existen, a qu칠 partes de nuestro sistema pueden y deber칤an ingresar, si tienen los permisos adecuados, entre otras cosas. Para este proceso podemos utilizar diferentes mecanismos: formularios de usuario y contrase침a, mensajes de texto, env칤o de URLs por correo electr칩nico, entre otras.

Autorizaci칩n: Consiste en definir los permisos y limitaciones de los usuarios que ya pasaron el proceso de autenticaci칩n. Esto mismo sucede con nuestras aplicaciones, algunos usuarios pueden tener permisos para escribir, actualizar o eliminar cierto contenido, mientras que otros solo pueden visualizar e interactuar con nuestra aplicaci칩n.

Tokens y JWT
Los JSON Web Tokens (JWT) son un est치ndar que nos permite representar los permisos o requerimientos de las aplicaciones.

Nuestro servidor concede los permisos para un usuario generando y guardando esta informaci칩n en tokens. Pero en vez de generar una cookie para almacenar los tokens, los enviamos al cliente o navegador de los usuarios para que el frontend se encargue de hacer peticiones a este o alg칰n otro servidor.

Gracias a los JWT podemos hacer peticiones y recibir la informaci칩n de los usuarios sin necesidad de verificar la identidad o permisos de los usuarios todo el tiempo. Por su puesto, estos tokens tienen un tiempo de vida limitado. Debemos configurar nuestra aplicaci칩n para solo entregar informaci칩n de los usuarios cuando estos se han autenticado (el servidor a firmado un token especial para ellos) y el tiempo de vida del token todav칤a es vigente.

Puedes leer un poco m치s sobre c칩mo funcionan los JWT en el siguiente art칤culo de @sergiodxa: Introducci칩n a JSON Web Tokens (JWT) en Platzi.

춰Ahora s칤! 쯈u칠 es OAuth?
OAuth (Open Authorization, versi칩n 2.0) es un est치ndar o protocolo que nos permite delegar la autenticaci칩n de nuestros usuarios a otros servicios.

El flujo de autorizaci칩n es el siguiente: Nuestra aplicaci칩n redirecciona a los usuarios para pedir permiso y acceder a parte de su informaci칩n. Si los usuarios aceptan, este servicio nos devuelve un token de acceso que podemos utilizar para consumir la informaci칩n protegida de nuestros usuarios.

Muchas compa침칤as y servicios populares (Google, Twitter, Github, Spotify y muchos otros) aprovechan muy bien este tipo de mecanismos para compartir sus APIs con otras aplicaciones o incluso para otros proyectos de las mismas marcas.

Art칤culo recomendado: Una introducci칩n a OAuth 2.0.

Conclusiones
쯈u칠 tipo de seguridad podemos utilizar en SPAs? 춰Esto s칤 es seguro de verdad!? 쮺u치les librer칤as utilizamos para implementar OAuth? 쯈u칠 hay de Open ID Connect!?

No hay problema, todas estas preguntas (y todas las que tengas) las puedes resolver tomando el Curso de Autenticaci칩n con OAuth con nuestro profesor @glrodasz, ingeniero en Auth0 y coorganizador de muchas comunidades como Medell칤n CSS.

========================================================================================================================================================================================================================================================
A tu autenticaci칩n le hace falta verificaci칩n

쯉ab칤as que tu aplicaci칩n con Node.js, esa que tienes con login de usuarios no es suficientemente segura? 춰Pero espera, no te vayas! Hay un middleware muy bueno que te ayudar치 a mejorarlo.

쯉abes qu칠 es un middleware?
Es un c칩digo que ayuda a una aplicaci칩n para interactuar o comunicarse con otras aplicaciones, paquetes de programas, redes, hardware o sistemas operativos.

Ahora, 쯖칩mo puedo mejorar la seguridad de mi login de usuarios?
Para eso ha llegado a tu salvaci칩n Passport.js, un middleware de autenticaci칩n para Node. Est치 dise침ado para servir a un prop칩sito singular que es autenticar solicitudes. No es pr치ctico almacenar la contrase침a del usuario como la cadena original en la base de datos, pero es una buena pr치ctica cifrar la contrase침a y luego almacenarla en la base de datos.

Proporciona tambi칠n una capa de abstracci칩n sobre el inicio de sesi칩n con varios proveedores como Facebook, Google, Github, Twitter y m치s.

Passport.js puede ser confuso al principio,pero cuando lo aprendes a manejar, ver치s que es muy f치cil usarlo, incluso en aplicaciones que est치n estructuradas de distintos modos.

Aqu칤 hay un simple ejemplo de c칩mo podemos registrar un usuario usando Facebook:

const passport = require('passport')
const FacebookStrategy = require('passport-facebook').Strategy;

passport.use(new FacebookStrategy({
    clientID: FACEBOOK_APP_ID,
    clientSecret: FACEBOOK_APP_SECRET,
    callbackURL: "http://www.example.com/auth/facebook/callback"
  },
  function(accessToken, refreshToken, profile, done) {
    User.findOrCreate(..., function(err, user) {
      if (err) { return done(err); }
      done(null, user);
    });
  }
));
Es un poco confuso s칤, pero lo que estamos haciendo es recoger las credenciales para d치rselas a Facebook, mandarle la URL a la cual har치 el fallback de registro y luego en la funci칩n lo que hacemos es registrar el usuario o buscar si ya est치 registrado e iniciar sesi칩n.

쯀nteresante y corto cierto? Pues cr칠eme que es muy f치cil manejar Passport para hacer autenticaci칩n de usuarios, pero, 쯤u칠 tal si unimos Passport con OpenID Connect para darle autorizaci칩n a los usuarios y darle m치s seguridad a nuestra aplicaci칩n?

Pues aprende esto y mucho m치s en nuestro Curso de Autenticaci칩n con Passport.js y 游끢 para que tus aplicaciones sean seguras y no puedan robarte f치cilmente datos de nuestros usuarios.

